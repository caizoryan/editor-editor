{
  "blocks": [
    {
      "type": "code",
      "id": "tma0w",
      "start": 0,
      "focused": false,
      "output": "import {mut} from \"/lib/solid/monke.js\"\n\nconst defer = (fn, t = 400) => setTimeout(fn, t)\nconst M = mut({})\ndocument.M = M\n\n\ndefer(function() { save_path(\"utils/fileviewer.json\") })\n\nfunction load_path(path){\n  if (M) { if (M.EDITOR) M.EDITOR.state.load(path) }\n}\n\nfunction save_path(path){\n  if (M) { if (M.EDITOR) M.EDITOR.state.save(path) }\n}\n\nfunction show_dir(path, dir){\n  let path_split = path.split(\"/\")\n  let path_slice = path_split.slice(0, path_split.length - 2)\n  let back_path = path_slice.join(\"/\")\n  let title = path == \"\" ? \"\" : \"../\" + back_path\n  let back = p(title, () => check_dir(back_path))\n  let files = dir.files.map((f) => p(f, () => check_dir(path+\"/\"+f)))\n  document.body.innerHTML = \"\"\n  document.body.appendChild(back)\n  files.forEach((f) => document.body.appendChild(f))\n}\n\nfunction file(src) {\n  let elem = document.createElement(\"iframe\")\n  elem.src = src\n  return elem\n}\n\nfunction p(text, onclick){\n  let elem = document.createElement(\"p\")\n  elem.innerText = text\n  elem.onclick = onclick\n\n  return elem\n}\n\nfunction check_dir(path = \"\", root = \"/fs/\"){\n  fetch(root+path)\n    .then((res) => {\n      try{ return res.json() }\n      catch { return null }\n    })\n    .then((res) => {\n      console.log(res)\n      if (!res) document.body.appendChild(file(root+path))\n      if (res.type == \"dir\") show_dir(path, res) \n      else document.body.appendChild(file(root+path))\n    })\n}\n\ncheck_dir(\"\")\n",
      "cursor": 1408,
      "active": true,
      "focus": true
    }
  ],
  "output": ""
}